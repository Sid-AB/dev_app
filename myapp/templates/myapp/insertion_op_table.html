{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'myapp/css/main.css' %}">
    <link rel="stylesheet" href="{% static 'myapp/fontawesome-free-5.15.4-web/css/all.min.css' %}">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title>Document</title>
</head>
<body>
  <div class="info-aria">
      <div>
      <label for="info-project" class="formbold-form-label"> Le Projet Selection Est : </label>
      <input
      type="text"
      name="firstname"
      placeholder="{{id_projet}}"
      id="PR"
      class="formbold-form-input"
       disabled/>
      </div>
    </div>
  <div class="form-aria">
    <form  method="POST" action="{% url 'app_view' id_projet%}">
      {% csrf_token %}
      <div class="formbold-form-step-1 active">
        <div class="formbold-input-flex">
          <div>
              <label for="Numero_Libelle" class="formbold-form-label"> Numero et Libellé d'indidualisation de l'operation </label>
              <input
              type="text"
              name="libelle"
              placeholder="Numero et Libellé d'indidualisation de l'operation"
              id="Numero_Libelle"
              class="formbold-form-input"
              />
          </div>
          <div>
              <label for="Objectif vise" class="formbold-form-label"> Objectif vise de L'Operation </label>
              <input
              type="text"
              name="Obj_vise"
              placeholder="Objectif vise de L'Operation"
              id="Objectif"
              class="formbold-form-input"
              />
          </div>
        </div>

        <div class="formbold-input-flex">
          <div>
            <label for="year" class="formbold-form-label">	
              Annee d'individualisation </label>
            <select 
            name="yearpicker_indiv" 
            id="yearpicker_indiv" 
            class="formbold-form-input"
            >
            </select>
        </div>
            <div>
              <label for="year" class="formbold-form-label"> Annee de Notification par le M F </label>
              <select 
              name="yearpicker_MF" 
              id="yearpicker_MF" 
              class="formbold-form-input"
              >
              </select>
          </div>
        </div>
        <label>A.P</label>
        <hr>
        <div class="formbold-input-flex">
          <div>
            <label for="AP_init" class="formbold-form-label"> 	
              A.P initiale
            </label>
            <input
            type="number"
             step="0.01"
            name="ap"
            id="AP_init"
            class="formbold-form-input"
            />
        </div>
          <div>
              <label for="AP_init" class="formbold-form-label"> 	
                A.P Actualle
              </label>
              <input
              type="number"
               step="0.01"
              name="ap_act"
              id="ap_act"
              class="formbold-form-input"
              />
          </div>
      </div>
      <label>Les Cumules</label>
      <hr>
      <div class="formbold-input-flex">
        <div>
          <label for="Cml_eng" class="formbold-form-label"> 	
            Cumul des A P engageés au 30-09-2023
          </label>
          <input
          type="number"
           step="0.01"
          name="Cml_eng"
          id="Cml_eng"
          class="formbold-form-input"
          />
        </div>
        <div>
            <label for="Cml_pai" class="formbold-form-label"> 	
              Cumul des paiements réelle au 30-09-2023
            </label>
            <input
            type="number"
             step="0.01"
            name="Cml_pai"
            id="Cml_pai"
            class="formbold-form-input"
            />
        </div>
       </div>
        <hr>
        <div>
            <label for="Contraintes" class="formbold-form-label"> 	
              Contraintes de la réalisation </label>
            <input
            type="text"
            name="Contraintes"
            id="cnt"
            placeholder="Contraintes de la réalisation"
            class="formbold-form-input"
            />
        </div>
      </div>
      <hr>
        <button class="formbold-btn">
            Ajouter
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_1675_1807)">
            <path d="M10.7814 7.33312L7.20541 3.75712L8.14808 2.81445L13.3334 7.99979L8.14808 13.1851L7.20541 12.2425L10.7814 8.66645H2.66675V7.33312H10.7814Z" fill="white"/>
            </g>
            <defs>
            <clipPath id="clip0_1675_1807">
            <rect width="16" height="16" fill="white"/>
            </clipPath>
            </defs>
            </svg>
        </button>
      </div>
  </form>
  <div>
    <table id="opr-table">
        <thead>
          <tr>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  N°
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  Numero et Libellé d'indidualisation de l'operation
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span id="order">
                  Objectif vise de L'Operation
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span id="order">
                  Annee de Notification par le M F
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  Annee d'individualisation
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  A.P initiale
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  A.P actuelle
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  Cumul des A P engageés au 30-09-2023
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  Cumul des paiements réelle au 30-09-2023
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  Taux de réalisation physique de l'operation au 30-09-2023
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                  Etat d'avancement
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
            <th>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span>
                 Contraintes de la réalisation
                </span> 
                <i class="fas fa-filter"></i>
                <span id="order">
                &;np
                </span>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>showSpeed</strong></td>
            <td>15</td>
            <td>The speed of the show/reveal</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><strong>showEasing</strong></td>
            <td>'linear'</td>
            <td>The easing of the show/reveal</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><strong>hideSpeed</strong></td>
            <td>50</td>
            <td>The speed of the hide/conceal</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><strong>hideEasing</strong></td>
            <td>'linear'</td>
            <td>The easing of the hide/conceal</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>         
          <tr>
            <td><strong>width</strong></td>
            <td>'auto'</td>
            <td>The width that the data will be truncated to - <em>('auto' or px amount)</em></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><strong>ellipsis</strong></td>
            <td>true</td>
            <td>Set to true to enable the ellipsis</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><strong>title</strong></td>
            <td>false</td>
            <td>Set to true to show the full data on hover</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><strong>afterShow</strong></td>
            <td> $.noop</td>
            <td>The callback fired after the show/reveal</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><strong>afterHide</strong></td>
            <td>$.noop</td>
            <td>The callback fired after the hide/conceal</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td> 
            <td></td>
            <td></td>
          </tr>
          {% for op in opr_list %}
            <tr>
              <td><strong></strong></td>
             <td>{{ op.id_libelle_op}}</td>
             <td>{{ op.num_op}}</td>
             <td>{{ op.object_vise_po}}</td>
             <td>{{ op.notifcation_an_MF_op}}</td>
             <td>{{ op.indiv_an_op}}</td>
             <td>{{ op.AP_init_op}}</td>
             <td>{{ op.AP_real_op}}</td>
             <td>{{ op.cum_AP_eng_an_op}}</td>
             <td>{{ op.cum_AP_pai_an_op}}</td> 
             <td>{{ op.taux_real_ph_an_op}}</td>
             <td>{{ op.date_cre_op}}</td>
            </tr>
           {% endfor %} 
        </tbody>
        <tfoot>
          <tr>
            <th colspan="5">pour les calcul</th>
            <th>$667.90</th>
            <th colspan="5">pour les calcul</th>
            <th>$667.90</th>
          </tr>
        </tfoot>
      </table>
      <input type="text" id="searchInput" placeholder="Search...">
      <button id="getVisibleRows">Get Visible Rows</button>
    </div>
</body>
<script type="text/javascript">
  let startYear = 1800;
  let endYear = new Date().getFullYear();
  for (i = endYear; i > startYear; i--)
  {
    $('#yearpicker_MF').append($('<option />').val(i).html(i));
    $('#yearpicker_indiv').append($('<option />').val(i).html(i));
  }
  $(document).ready(function(){
	function sortTable(table, col, reverse) {
    var rows = table.find('tbody > tr').get();

    rows.sort(function(a, b) {
      var A = $(a).children('td').eq(col).text().toUpperCase();
      var B = $(b).children('td').eq(col).text().toUpperCase();

      if($.isNumeric(A) && $.isNumeric(B)) {
        return reverse ? B - A : A - B;
      } else {
        return (A < B ? -1 : (A > B ? 1 : 0)) * (reverse ? -1 : 1);
      }
    });

    $.each(rows, function(index, row) {
      table.children('tbody').append(row);
    });
  }

  // Click event to sort the table when header is clicked
  $('#opr-table th').on('click', function() {
    var table = $(this).parents('table').eq(0);
    var index = $(this).index();
    var reverse = $(this).hasClass('asc');
    
    sortTable(table, index, reverse);
    
    // Toggle the class for next click
    $('#opr-table th').removeClass('asc desc');
    $(this).addClass(reverse ? 'desc' : 'asc');
  }); 
})
$(document).ready(function(){
  // Filter table rows based on search input
  $("#searchInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#opr-table tbody tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });

  // Get all visible rows
  $("#getVisibleRows").on("click", function() {
    var visibleRows = $("#opr-table tbody tr:visible");

    // Example: Log all visible rows to the console
    visibleRows.each(function() {
      var rowText = $(this).text();
      console.log(rowText);
    });

    // Example: Display the count of visible rows
    alert("Number of visible rows: " + visibleRows.length);
  });
});
  </script>
</html>
